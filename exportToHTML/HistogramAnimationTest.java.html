<html>
<head>
<title>HistogramAnimationTest.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #000080; font-weight: bold;}
.s1 { color: #000000;}
.s2 { color: #0000ff;}
.s3 { color: #008000; font-weight: bold;}
.s4 { color: #808080; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
HistogramAnimationTest.java</font>
</center></td></tr></table>
<pre><span class="s0">import </span>java.awt.Font;

<span class="s0">import </span>java.awt.Color;
<span class="s0">import </span>java.io.*;
<span class="s0">import </span>javax.json.*;

<span class="s0">public class </span>HistogramAnimationTest {
    <span class="s0">public static void </span>main(String[] args) {
        HistogramAnimation h = <span class="s0">null</span>;
        <span class="s0">for </span>(<span class="s0">int </span>i = <span class="s2">0</span>; i &lt; args.length; i++) {
            h = createHistogramAFrom(args[i]);
            h.animate();
        }
    }

    <span class="s0">private static </span>HistogramAnimation createHistogramAFrom (String fileName) {
        HistogramAnimation h = <span class="s0">null</span>;
        <span class="s0">try </span>(
                InputStream is = <span class="s0">new </span>FileInputStream( <span class="s0">new </span>File( fileName ));
                JsonReader rdr = Json.createReader(is)
        ) {
            JsonObject obj = rdr.readObject().getJsonObject( <span class="s3">&quot;histograma&quot; </span>);
            Canvas canvas = getCanvasFrom( obj.getJsonObject( <span class="s3">&quot;canvas&quot; </span>));
            Formats fmts = getFormatsFrom( obj.getJsonObject( <span class="s3">&quot;formats&quot; </span>));
            HistogramData data = getDataFrom( obj.getJsonObject( <span class="s3">&quot;data&quot; </span>));
            h =  <span class="s0">new </span>HistogramAnimation( canvas, fmts, data);
        } <span class="s0">catch </span>(IOException e) {
            System.out.println( e.getMessage());
        };
        <span class="s0">return </span>h;
    }

    <span class="s0">private static </span>Canvas getCanvasFrom( JsonObject obj) {
        Canvas canvas = <span class="s0">new </span>Canvas();

        JsonArray szArray = obj.getJsonArray( <span class="s3">&quot;size&quot; </span>);
        <span class="s0">if </span>(szArray != <span class="s0">null </span>) {  <span class="s4">// otherwise, use the default size</span>
            <span class="s0">int</span>[] size = toIntArray( szArray);
            canvas.x = size[<span class="s2">0</span>];
            canvas.y = size[<span class="s2">1</span>];
        }

        JsonArray xsArray = obj.getJsonArray( <span class="s3">&quot;xscale&quot; </span>);
        <span class="s0">if </span>(xsArray != <span class="s0">null </span>)  <span class="s4">// otherwise, use the default xScale</span>
            canvas.xScale = toDoubleArray( xsArray );

        JsonArray ysArray = obj.getJsonArray( <span class="s3">&quot;yscale&quot; </span>);
        <span class="s0">if </span>(ysArray != <span class="s0">null </span>)  <span class="s4">// otherwise, use the default yScale</span>
            canvas.yScale = toDoubleArray( ysArray );

        JsonArray bgcArray = obj.getJsonArray( <span class="s3">&quot;bgcolor&quot;</span>);
        <span class="s0">if </span>(bgcArray != <span class="s0">null </span>)  <span class="s4">// otherwise, use the default bgColor</span>
            canvas.bgColor = getColorFrom( bgcArray);

        JsonArray cArray = obj.getJsonArray( <span class="s3">&quot;color&quot;</span>);
        <span class="s0">if </span>(cArray != <span class="s0">null </span>)    <span class="s4">// otherwise, use the default color</span>
            canvas.color = getColorFrom( cArray);

        <span class="s0">return </span>canvas;
    }

    <span class="s0">private static int</span>[] toIntArray (JsonArray jsa) {
        <span class="s0">int</span>[] a = <span class="s0">new int</span>[jsa.size()];
        <span class="s0">for </span>(<span class="s0">int </span>i = <span class="s2">0</span>; i &lt; jsa.size(); i++)
            a[i] = jsa.getInt(i);
        <span class="s0">return </span>a;
    }

    <span class="s0">private static double</span>[] toDoubleArray (JsonArray jsa) {
        <span class="s0">if </span>(jsa == <span class="s0">null</span>) <span class="s0">return new double</span>[<span class="s2">0</span>];
        <span class="s0">double</span>[] a = <span class="s0">new double</span>[jsa.size()];
        <span class="s0">for </span>(<span class="s0">int </span>i = <span class="s2">0</span>; i &lt; jsa.size(); i++)
            a[i] = jsa.getJsonNumber(i).doubleValue();
        <span class="s0">return </span>a;
    }
    <span class="s0">private static double</span>[][] to2DDoubleArray (JsonArray jsas) {
        <span class="s0">double</span>[][] d = <span class="s0">new double</span>[jsas.size()][];
        <span class="s0">int </span>i = <span class="s2">0</span>;
        <span class="s0">for </span>(JsonArray jsa : jsas.getValuesAs(JsonArray.<span class="s0">class</span>))
            d[i++] = toDoubleArray( jsa );
        <span class="s0">return </span>d;
    }

    <span class="s0">private static int</span>[][] to2DIntArray (JsonArray jsas) {
        <span class="s0">int</span>[][] d = <span class="s0">new int</span>[jsas.size()][];
        <span class="s0">int </span>i = <span class="s2">0</span>;
        <span class="s0">for </span>(JsonArray jsa : jsas.getValuesAs(JsonArray.<span class="s0">class</span>))
            d[i++] = toIntArray( jsa );
        <span class="s0">return </span>d;
    }

    <span class="s0">private static </span>String[] toStringArray (JsonArray jsa) {
        String[] s = <span class="s0">new </span>String[jsa.size()];
        <span class="s0">for </span>(<span class="s0">int </span>i = <span class="s2">0</span>; i &lt; jsa.size(); i++)
            s[i] = jsa.getString(i);
        <span class="s0">return </span>s;
    }

    <span class="s0">private static </span>Color getColorFrom(JsonArray jsa) {
        <span class="s0">int</span>[] c = toIntArray( jsa);
        <span class="s0">return new </span>Color( c[<span class="s2">0</span>], c[<span class="s2">1</span>], c[<span class="s2">2</span>]);
    }
    <span class="s0">private static </span>Color getColorFrom (JsonArray jsa, Color defaultColor) {
        <span class="s0">if </span>(jsa == <span class="s0">null</span>) <span class="s0">return </span>defaultColor;
        <span class="s0">int</span>[] c = toIntArray( jsa);
        <span class="s0">return new </span>Color( c[<span class="s2">0</span>], c[<span class="s2">1</span>], c[<span class="s2">2</span>]);
    }
    <span class="s0">private static </span>Font getFontFrom(JsonArray jsa) {
        String[] s = toStringArray(jsa);
        <span class="s0">return new </span>Font(s[<span class="s2">0</span>], Font.PLAIN, Integer.parseInt(s[<span class="s2">1</span>]));
    }

    <span class="s0">private static </span>Formats getFormatsFrom( JsonObject obj) {
        Formats fmts = <span class="s0">new </span>Formats();
        <span class="s0">if</span>(obj.containsKey( <span class="s3">&quot;margins&quot;</span>))
            fmts.margins = toDoubleArray( obj.getJsonArray( <span class="s3">&quot;margins&quot;</span>));

        fmts.isBarFilled = obj.getBoolean( <span class="s3">&quot;isbarfilled&quot;</span>, <span class="s0">true</span>);

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;barfillcolor&quot;</span>))
            fmts.barFillColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;barfillcolor&quot;</span>));

        fmts.hasBarFrame = obj.getBoolean( <span class="s3">&quot;hasbarframe&quot;</span>, <span class="s0">true</span>);

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;barframecolor&quot;</span>))
            fmts.barFrameColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;barframecolor&quot;</span>));

        fmts.hasBorder = obj.getBoolean( <span class="s3">&quot;hasborder&quot;</span>, <span class="s0">true</span>);

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;bordercolor&quot;</span>))
            fmts.borderColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;bordercolor&quot;</span>));

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;rulercolor&quot;</span>))
            fmts.rulerColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;rulercolor&quot;</span>));

        <span class="s0">if </span>(obj.containsKey(<span class="s3">&quot;rulermarkcolor&quot;</span>))
            fmts.rulerMarkColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;rulermarkcolor&quot;</span>));

        fmts.hasRightRuler = obj.getBoolean( <span class="s3">&quot;hasrightruler&quot;</span>, <span class="s0">true</span>);

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;keycolor&quot;</span>))
            fmts.keyColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;keycolor&quot;</span>));

        fmts.hasHeader = obj.getBoolean( <span class="s3">&quot;hasheader&quot;</span>, <span class="s0">true</span>);

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;headercolor&quot;</span>))
            fmts.headerColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;headercolor&quot;</span>));

        fmts.hasFooter = obj.getBoolean( <span class="s3">&quot;hasfooter&quot;</span>, <span class="s0">true</span>);

        <span class="s0">if </span>(obj.containsKey(<span class="s3">&quot;footercolor&quot;</span>))
            fmts.footerColor = getColorFrom( obj.getJsonArray( <span class="s3">&quot;footercolor&quot;</span>));

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;rulerfont&quot;</span>))
            fmts.rulerFont = getFontFrom(obj.getJsonArray(<span class="s3">&quot;rulerfont&quot;</span>));

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;keyfont&quot;</span>))
            fmts.keyFont = getFontFrom(obj.getJsonArray(<span class="s3">&quot;keyfont&quot;</span>));

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;headerfont&quot;</span>))
            fmts.headerFont = getFontFrom(obj.getJsonArray(<span class="s3">&quot;headerfont&quot;</span>));

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;footerfont&quot;</span>))
            fmts.footerFont = getFontFrom(obj.getJsonArray(<span class="s3">&quot;footerfont&quot;</span>));

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;rulernumberformat&quot;</span>))
            fmts.rulerNumberFormat = obj.getString(<span class="s3">&quot;rulernumberformat&quot;</span>);

        <span class="s0">if</span>(obj.containsKey(<span class="s3">&quot;stepfont&quot;</span>))
            fmts.stepFont = getFontFrom(obj.getJsonArray(<span class="s3">&quot;stepfont&quot;</span>));

        <span class="s0">if </span>(obj.containsKey(<span class="s3">&quot;visiblecount&quot;</span>))
            fmts.visibleCount = obj.getInt(<span class="s3">&quot;visiblecount&quot;</span>);

<span class="s4">//      fmts.colorList = to2DIntArray(obj.getJsonArray(&quot;colors&quot;));</span>

        <span class="s0">return </span>fmts;
    }

    <span class="s0">private static </span>HistogramData getDataFrom( JsonObject obj) {
        HistogramData data = <span class="s0">new </span>HistogramData();
        data.header = obj.getString( <span class="s3">&quot;header&quot;</span>, <span class="s3">&quot;&quot;</span>);
        data.footer = obj.getString( <span class="s3">&quot;footer&quot;</span>, <span class="s3">&quot;&quot;</span>);
        data.minValue = obj.getJsonNumber( <span class="s3">&quot;minvalue&quot;</span>) != <span class="s0">null </span>?
                obj.getJsonNumber( <span class="s3">&quot;minvalue&quot;</span>).doubleValue()
                : <span class="s2">0</span>;
        data.steps = toStringArray( obj.getJsonArray( <span class="s3">&quot;steps&quot;</span>));
        data.labels = toStringArray(obj.getJsonArray(<span class="s3">&quot;labels&quot;</span>));
        data.values = to2DDoubleArray( obj.getJsonArray( <span class="s3">&quot;values&quot;</span>));
        <span class="s0">return </span>data;
    }
}
</pre>
</body>
</html>